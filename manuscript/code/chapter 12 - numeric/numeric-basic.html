<html>
<head>
        <script type="text/javascript" src="d3.v3.min.js"></script>
        <script type="text/javascript" src="numeric-1.2.6.min.js"></script>
        <script type="text/javascript" src="quandl-api-key.js"></script>
        <script type="text/javascript" src="underscore-min.js"></script>
        <script type="text/javascript" src="jstat.min.js"></script>
</head>
<body>
        <div id='graph' style="width:800;height:700"></div>
</body>
<script>
        var quandlApiKey = "";
</script>
<script type="text/javascript" src="quandl-api-key.js"></script>
<script>
        "use strict";
        //accumulate data and plot
        const postBox = function*(){
                const a = yield;
                
                const closePrices = _.chain(a)
                        .pluck("Close")
                        .map(x => +x);
                
                const before = closePrices.rest().value();
                const after = closePrices.initial().value();
                
                const returns = numeric.log( numeric['/'](after, before) );
                
                const mean = jStat.mean(returns);
                
                const demeanedReturns = numeric['-'](returns,mean);
                
                console.log(jStat.mean(demeanedReturns));
                
                
                
                }
        
        //init
        const send = postBox();
        send.next();
        
        d3.csv( "https://www.quandl.com/api/v3/datasets/YAHOO/FB.csv?auth_token="+quandlApiKey, 
                data => send.next( data ) 
                )
               
        
</script>
</html>
